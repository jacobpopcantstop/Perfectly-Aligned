<!DOCTYPE html> <!-- Added Doctype -->
<html lang="en"> <!-- Added lang attribute -->
<head>
    <meta charset="UTF-8"> <!-- Character encoding for HTML5 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Added viewport for responsiveness -->
    <title>Perfectly Aligned - Game Helper</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="assets/images/ui/favicon.png">
<!-- If you made an .ico -->
<!-- <link rel="icon" href="assets/images/ui/favicon.png"> -->
    <!-- Tutorial CSS file if needed later -->
    <!-- <link rel="stylesheet" href="tutorial.css"> -->
</head>
<body>
    <!-- === NEW Tutorial Overlay === -->
    <div id="tutorial-overlay" class="tutorial-overlay" style="display: none;">
        <div id="tutorial-box" class="tutorial-box">
            <h3 id="tutorial-title">Welcome!</h3>
            <p id="tutorial-text">Let's learn how to play!</p>
            <div class="tutorial-navigation">
                <button id="tutorial-prev" type="button" disabled>Previous</button>
                <span id="tutorial-step-indicator">Step 1/X</span>
                <button id="tutorial-next" type="button">Next</button>
                <button id="tutorial-skip" type="button">Exit</button> <!-- Renamed button -->
            </div>
        </div>
    </div>

    <h1>Perfectly Aligned</h1>
    <p class="subtitle">The creative drawing game for ethically dubious people!</p> <!-- Removed inline style -->
    <!-- Rules link area removed -->
    <button id="show-tutorial-button" type="button" style="display: block; margin: 10px auto;">Show Tutorial</button> <!-- Button to re-show tutorial -->

    <!-- === SETUP SECTION === -->
    <div id="setup-area"> <!-- Removed inline style -->
        <h2>Game Setup</h2>
        <div class="setup-control-group">
            <label for="party-count-display">Players Ready? (3-8)</label> <!-- Changed label text -->
            <div class="party-size-control">
                <button id="decrement-player-count" class="player-count-btn" type="button">-</button>
                <span id="party-count-display" class="party-count-display">3</span>
                <button id="increment-player-count" class="player-count-btn" type="button">+</button>
            </div>
            <button id="set-players-button" type="button">Enter Player Names</button>
            <span id="player-count-error" class="error-message" role="alert" aria-live="polite"></span>
        </div>

        <!-- This div will hold the name and avatar inputs -->
        <div id="player-setup-area">
            <p><em>Click 'Enter Player Names' to summon the name & avatar fields...</em></p>
            <!-- Example Input (for reference, actual inputs generated by JS) with 10 character limit -->
            <!-- This is just a placeholder; actual inputs are generated by JS -->
            <!--
            <input type="text" maxlength="10" placeholder="Player Name (max 10 chars)">
            -->
            <span id="player-names-error" class="error-message" role="alert" aria-live="polite"></span> <!-- Added error message container -->
        </div>

        <!-- Deck Selection -->
        <div id="deck-selection-area">
            <h4>Customize your card options!!</h4> <!-- Added header for decks -->
            <div class="deck-option">
                <label class="deck-label selected" data-deck-key="core_white">Core Mix</label> <!-- Renamed -->
            </div>
            <div class="deck-option">
                <label class="deck-label selected" data-deck-key="creative_cyan">Creative & Pop</label> <!-- Renamed -->
            </div>
            <div class="deck-option">
                <label class="deck-label selected" data-deck-key="hypothetical_magenta">Hypothetical & Taboo (17+)</label> <!-- Renamed & added warning -->
            </div>
            <!-- Add more deck options -->
        </div>

        <button id="start-game-button" type="button" disabled>Let's Play!</button> <!-- Added type="button" -->
    </div>
    <!-- === END SETUP SECTION === -->

    <!-- === GAME AREA (Initially Hidden) === -->
    <div id="game-area" style="display: none;"> <!-- Keeping display:none for initial state -->
        <div class="game-header"> <!-- Wrapper for H2 and Avatar -->
            <h2>Current Round <span id="round-number-display">1</span></h2> <!-- Added round number display -->
            <!-- Judge Name Paragraph -->
            <p>Judge: <span id="judge-name" aria-live="polite">Calculating...</span></p> <!-- Added aria-live -->
            <!-- Add the steal button here -->
            <button id="initiate-steal-button" class="judge-action-button" style="display: none;" title="">Steal Point</button> <!-- Added empty title attribute -->
            <!-- MOVED Judge Avatar Here -->
            <div id="judge-avatar-display" title="Current Judge"></div>
        </div>

        <!-- Alignment Section -->
        <div id="alignment-section">
            <div class="alignment-roll-area">
                <button id="roll-button" type="button">Roll Alignment!</button> <!-- Added type="button" -->
                <span id="die-display" aria-live="polite">?</span> <!-- Added aria-live -->
            </div>
            <!-- Alignment Grid -->
            <div id="alignment-chart-grid" role="grid"> <!-- Added role="grid" -->
                <div class="alignment-cell align-lawful align-good" data-alignment="LG" role="gridcell" tabindex="0" title="Lawful Good">LG</div> <!-- Added role and tabindex -->
                <div class="alignment-cell align-neutral-col align-good" data-alignment="NG" role="gridcell" tabindex="0" title="Neutral Good">NG</div>
                <div class="alignment-cell align-chaotic align-good" data-alignment="CG" role="gridcell" tabindex="0" title="Chaotic Good">CG</div>
                <div class="alignment-cell align-lawful align-neutral-row" data-alignment="LN" role="gridcell" tabindex="0" title="Lawful Neutral">LN</div>
                <div class="alignment-cell align-neutral-col align-true-neutral" data-alignment="TN" role="gridcell" tabindex="0" title="True Neutral">TN</div>
                <div class="alignment-cell align-chaotic align-neutral-row" data-alignment="CN" role="gridcell" tabindex="0" title="Chaotic Neutral">CN</div>
                <div class="alignment-cell align-lawful align-evil" data-alignment="LE" role="gridcell" tabindex="0" title="Lawful Evil">LE</div>
                <div class="alignment-cell align-neutral-col align-evil" data-alignment="NE" role="gridcell" tabindex="0" title="Neutral Evil">NE</div>
                <div class="alignment-cell align-chaotic align-evil" data-alignment="CE" role="gridcell" tabindex="0" title="Chaotic Evil">CE</div>
            </div>
            <!-- Alignment Examples (Initially Hidden) -->
            <div id="alignment-examples" style="display: none;" aria-live="polite"> <!-- Keeping display:none, added aria-live -->
                <p><em>Hover over grid or wait for roll...</em></p>
            </div>
        </div>

        <!-- Prompt Section -->
        <div id="prompt-section">
            <button id="draw-prompts-button" type="button">Draw Prompts!</button> <!-- Added type="button" -->
            <button id="redraw-prompts-button" type="button" style="display: none;">Re-draw Prompts (Cost: 1 Token)</button> <!-- Renamed ID and text, Added type="button", keeping display:none -->
            <div id="prompt-display-area">
                <p>Judge: Click "Draw Prompts" or lock it in!</p>
                <ul id="prompt-list-clickable" role="listbox"> <!-- Added role -->
                    <!-- List items populated by JS will need role="option" -->
                    <li id="prompt-1" class="prompt-choice" data-prompt-index="0">-</li>
                    <li id="prompt-2" class="prompt-choice" data-prompt-index="1">-</li>
                    <li id="prompt-3" class="prompt-choice" data-prompt-index="2">-</li>
                </ul>
            </div>
        </div>

        <!-- === START Sketch Instruction & Timer Area === -->
        <div id="sketch-instruction-area" style="display: none;"> <!-- Keeping display:none -->
            <h4>Sketch Time!</h4>
            <p id="sketch-instruction-text" aria-live="polite">Players, prepare to sketch...</p> <!-- Added aria-live -->
            <div id="sketch-timer">
                <span class="timer-label" id="timer-min-label">Bullet (0:15)</span>
                <label for="timer-slider" class="sr-only" id="timer-slider-label">Timer Duration</label> <!-- Added screen-reader only label -->
                <input type="range" id="timer-slider" min="15" max="165" step="15" value="90" aria-labelledby="timer-slider-label timer-min-label timer-max-label timer-display"> <!-- Added aria-labelledby -->
                <span class="timer-label" id="timer-max-label">Masterpiece (2:45)</span>
                <span id="timer-display" aria-live="polite">01:30</span> <!-- Added aria-live -->
                <button id="start-timer-button" type="button">Start</button> <!-- Added type="button" -->
                <button id="stop-timer-button" type="button" disabled>Stop</button> <!-- Added type="button" -->
                <button id="reset-timer-button" type="button">Reset</button> <!-- Added type="button" -->
            </div>
        </div>
        <!-- === END Sketch Instruction & Timer Area === -->

        <!-- Round Actions Section -->
        <div id="round-actions-section">
            <div id="winner-selection-area">
                <h3>Choose the Winner:</h3>
                <div id="winner-button-container">
                    <!-- Buttons populated by JS -->
                    <p><em>Waiting for players...</em></p>
                </div>
            </div>
            <div id="player-token-award-area">
                <h5>Award Achievement Tokens (Optional):</h5>
                <!-- Token choices populated by JS -->
            </div>
            <button id="award-button" type="button" disabled>Award Point & Advance</button> <!-- Added type="button" -->
        </div>

        <!-- Scoreboard Section -->
        <div id="scoreboard-section">
            <h3>Scoreboard (Target: <span id="target-score-display">?</span>)</h3>
            <ul id="scoreboard-list" aria-live="polite"> <!-- Added aria-live -->
                <!-- Scoreboard populated by JS, will include avatars -->
            </ul>
        </div>
    </div>
    <!-- === END GAME AREA === -->

    <!-- === WINNER AREA (Initially Hidden) === -->
    <div id="winner-area" style="display: none;"> <!-- Keeping display:none -->
        <h2>Game Over!</h2>
        <p><span id="winner-name">You</span> are Perfectly Aligned!</p>
        <p>Victory Achieved!</p>
        <button id="play-again-button" type="button">Play Again?</button> <!-- Added type="button" -->
    </div>
    <!-- === END WINNER AREA === -->

    <!-- === Audio Elements (Hidden) === -->
    <!-- Add more as needed -->
    <audio id="sfx-roll" src="assets/audio/roll.wav" preload="auto"></audio>
    <audio id="sfx-timer-end" src="assets/audio/timer_end.wav" preload="auto"></audio>
    <audio id="sfx-token-gain" src="assets/audio/token_gain.wav" preload="auto"></audio>
    <audio id="sfx-point-gain" src="assets/audio/point_gain.wav" preload="auto"></audio>
    <audio id="sfx-steal" src="assets/audio/steal.wav" preload="auto"></audio>
    <audio id="sfx-win" src="assets/audio/win.wav" preload="auto"></audio>
    <audio id="sfx-draw-prompts" src="assets/audio/draw_prompts.wav" preload="auto"></audio> <!-- Added draw prompts sound -->
    <!-- Removed click.wav as it doesn't exist -->

    <!-- === Steal Modal (Hidden) === -->
    <div id="steal-modal-overlay" class="modal-overlay" style="display: none;">
        <div id="steal-modal-box" class="modal-box">
            <h3 id="steal-modal-title">Steal a Point</h3>
            <p id="steal-modal-info">Choose a player to steal 1 point from (costs 3 tokens):</p>
            <div id="steal-modal-targets">
                <!-- Target buttons will be dynamically added here -->
            </div>
            <div class="modal-buttons">
                <button id="steal-modal-cancel" class="ui-button">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Steal Point Modal -->
    <div id="steal-modal-overlay" class="modal-overlay">
        <div id="steal-modal-box" class="modal-box">
            <button id="steal-modal-close" class="modal-close-button" aria-label="Close">&times;</button>
            <h3 id="steal-modal-title">Steal a Point?</h3>
            <p id="steal-modal-instruction">Choose a player to steal 1 point from:</p>
            <div id="steal-modal-targets" class="steal-targets-container">
                <!-- Player targets will be populated here by JavaScript -->
            </div>
            <div class="modal-buttons">
                <button id="steal-modal-cancel" class="cancel-button">Cancel</button>
            </div>
        </div>
    </div>

    <!-- === Scripts === -->
    <script type="module" src="constants.js"></script>
    <script type="module" src="state.js"></script>
    <!-- <script src="ui.js"></script> --> <!-- Link new JS files if splitting logic -->
    <!-- <script src="gameLogic.js" defer></script> -->
    <script type="module" src="script.js" defer></script>
</body>
</html>